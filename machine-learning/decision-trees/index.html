<!doctype html><html lang=en class="js csstransforms3d"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12858299-25"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-12858299-25');</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://tutswiki.com/machine-learning/decision-trees/><meta name=keywords content="machine-learning,algorithms,decision-trees"><meta name=description content="Decision trees are supervised learning models utilized for regression and classification. It uses a single tree that can be visualized and the way the Tree has decided to predict/classify its final output gives decision trees high interpretability."><meta name=author content="Chankey Pathak"><link rel=icon href=/images/favicon.png type=image/png><title>An insight to Decision Trees :: TutsWiki Beta</title><link href=/css/nucleus.css?1605243543 rel=stylesheet><link href=/css/fontawesome-all.min.css?1605243543 rel=stylesheet><link href=/css/hybrid.css?1605243543 rel=stylesheet><link href=/css/featherlight.min.css?1605243543 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1605243543 rel=stylesheet><link href=/css/auto-complete.css?1605243543 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1605243543 rel=stylesheet><link href=/css/theme.css?1605243543 rel=stylesheet><link href=/css/hugo-theme.css?1605243543 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1605243543></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=/machine-learning/decision-trees/><nav id=sidebar><div id=header-wrapper><div id=header><a href=/><img src=https://tutswiki.com/img/tutswiki-logo.png style=width:70%></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1605243543></script><script type=text/javascript src=/js/auto-complete.js?1605243543></script><script type=text/javascript>var baseurl="https:\/\/tutswiki.com\/";</script><script type=text/javascript src=/js/search.js?1605243543></script></div><div class=highlightable><ul class=topics><li data-nav-id=/ml/ title="Machine Learning" class="dd-item
parent"><a href=/ml/><b></b>Machine Learning</a><ul><li data-nav-id=/machine-learning/decision-trees/ title="An insight to Decision Trees" class="dd-item active"><a href=/machine-learning/decision-trees/>Decision Trees</a></li></ul></li><li data-nav-id=/cplusplus/ title=C++ class=dd-item><a href=/cplusplus/><b></b>C++</a><ul><li data-nav-id=/cplusplus/introduction/ title=Introduction class=dd-item><a href=/cplusplus/introduction/>Introduction</a></li><li data-nav-id=/cplusplus/installation/ title="C++ Installation and Environment Setup" class=dd-item><a href=/cplusplus/installation/>Installation</a></li><li data-nav-id=/cplusplus/functions/ title="Functions in C++" class=dd-item><a href=/cplusplus/functions/>Functions</a></li><li data-nav-id=/cplusplus/multithreading/ title="Multithreading in C++" class=dd-item><a href=/cplusplus/multithreading/>Multithreading</a></li></ul></li><li data-nav-id=/data-structures-algorithms/ title=DSA class=dd-item><a href=/data-structures-algorithms/><b></b>DSA</a><ul><li data-nav-id=/data-structures-algorithms/insertion-sort/ title="Insertion Sort" class=dd-item><a href=/data-structures-algorithms/insertion-sort/>Insertion Sort</a></li><li data-nav-id=/data-structures-algorithms/bubble-sort/ title="Bubble Sort" class=dd-item><a href=/data-structures-algorithms/bubble-sort/>Bubble Sort</a></li><li data-nav-id=/data-structures-algorithms/radix-sort/ title="Radix Sort" class=dd-item><a href=/data-structures-algorithms/radix-sort/>Radix Sort</a></li><li data-nav-id=/data-structures-algorithms/bucket-sort/ title="Bucket Sort" class=dd-item><a href=/data-structures-algorithms/bucket-sort/>Bucket Sort</a></li><li data-nav-id=/data-structures-algorithms/counting-sort/ title="Counting Sort" class=dd-item><a href=/data-structures-algorithms/counting-sort/>Counting Sort</a></li><li data-nav-id=/data-structures-algorithms/quick-sort/ title="Quick Sort" class=dd-item><a href=/data-structures-algorithms/quick-sort/>Quick Sort</a></li><li data-nav-id=/data-structures-algorithms/heap-sort/ title="Heap Sort" class=dd-item><a href=/data-structures-algorithms/heap-sort/>Heap Sort</a></li><li data-nav-id=/data-structures-algorithms/merge-sort/ title="Merge Sort" class=dd-item><a href=/data-structures-algorithms/merge-sort/>Merge Sort</a></li><li data-nav-id=/data-structures-algorithms/tree-data-structure/ title="Tree Data Structure" class=dd-item><a href=/data-structures-algorithms/tree-data-structure/>Tree Data Structure</a></li><li data-nav-id=/data-structures-algorithms/binary-search-tree/ title="Binary Search Tree" class=dd-item><a href=/data-structures-algorithms/binary-search-tree/>Binary Search Tree</a></li><li data-nav-id=/data-structures-algorithms/binary-search/ title="Binary Search" class=dd-item><a href=/data-structures-algorithms/binary-search/>Binary Search</a></li><li data-nav-id=/data-structures-algorithms/interpolation-search/ title="Interpolation Search" class=dd-item><a href=/data-structures-algorithms/interpolation-search/>Interpolation Search</a></li><li data-nav-id=/data-structures-algorithms/exponential-search/ title="Exponential Search" class=dd-item><a href=/data-structures-algorithms/exponential-search/>Exponential Search</a></li></ul></li><li data-nav-id=/java/ title=Java class=dd-item><a href=/java/><b></b>Java</a><ul><li data-nav-id=/java/class-object/ title="Classes & Objects" class=dd-item><a href=/java/class-object/>Classes & Objects</a></li><li data-nav-id=/java/constructors/ title=Constructors class=dd-item><a href=/java/constructors/>Constructors</a></li><li data-nav-id=/java/wrapper-class/ title="Wrapper Class in Java" class=dd-item><a href=/java/wrapper-class/>Wrapper Class</a></li><li data-nav-id=/java/serialization/ title="Serialization in Java" class=dd-item><a href=/java/serialization/>Serialization</a></li><li data-nav-id=/java/exceptions/ title="Exceptions in Java" class=dd-item><a href=/java/exceptions/>Exceptions</a></li><li data-nav-id=/java/exception-handling/ title="Exception Handling" class=dd-item><a href=/java/exception-handling/>Exception Handling</a></li><li data-nav-id=/java/throw-throws/ title="throw and throws" class=dd-item><a href=/java/throw-throws/>throw and throws</a></li><li data-nav-id=/java/finally/ title=finally class=dd-item><a href=/java/finally/>finally</a></li><li data-nav-id=/java/lambda-expressions/ title="Lambda Expressions in Java" class=dd-item><a href=/java/lambda-expressions/>Lambda Expressions</a></li><li data-nav-id=/java/regex/ title="Regular Expressions in Java" class=dd-item><a href=/java/regex/>Regular Expressions</a></li><li data-nav-id=/java/garbage-collection/ title="Garbage Collection in Java" class=dd-item><a href=/java/garbage-collection/>Garbage Collection</a></li><li data-nav-id=/java/annotations/ title="Annotations in Java" class=dd-item><a href=/java/annotations/>Annotations</a></li><li data-nav-id=/java/postgresql/ title="PostgreSQL in Java" class=dd-item><a href=/java/postgresql/>Database - PostgreSQL</a></li><li data-nav-id=/java/generics/ title="Generics in Java" class=dd-item><a href=/java/generics/>Generics</a></li><li data-nav-id=/java/collections/ title="Collections in Java" class=dd-item><a href=/java/collections/>Collections</a></li></ul></li><li data-nav-id=/python/ title=Python class=dd-item><a href=/python/><b></b>Python</a><ul><li data-nav-id=/python/introduction/ title=Introduction class=dd-item><a href=/python/introduction/>Introduction</a></li><li data-nav-id=/python/threading/ title="Threading in Python" class=dd-item><a href=/python/threading/>Threading</a></li><li data-nav-id=/python/modules/ title="Modules in Python" class=dd-item><a href=/python/modules/>Modules</a></li><li data-nav-id=/python/decorators/ title="Decorators in Python" class=dd-item><a href=/python/decorators/>Decorators</a></li><li data-nav-id=/python/exceptions/ title="Exceptions in Python" class=dd-item><a href=/python/exceptions/>Exceptions</a></li><li data-nav-id=/python/exception-handling/ title="Exception Handling in Python" class=dd-item><a href=/python/exception-handling/>Exception Handling</a></li></ul></li><li data-nav-id=/pandas-cookbook/ title="Pandas Cookbook" class=dd-item><a href=/pandas-cookbook/><b></b>Pandas Cookbook</a><ul><li data-nav-id=/pandas-cookbook/chapter1/ title="Chapter 1 - Reading from a CSV" class=dd-item><a href=/pandas-cookbook/chapter1/>Chapter 1</a></li><li data-nav-id=/pandas-cookbook/chapter2/ title="Chapter 2 - Selecting and finding desired data" class=dd-item><a href=/pandas-cookbook/chapter2/>Chapter 2</a></li><li data-nav-id=/pandas-cookbook/chapter3/ title="Chapter 3 - Filtering dataframes" class=dd-item><a href=/pandas-cookbook/chapter3/>Chapter 3</a></li><li data-nav-id=/pandas-cookbook/chapter4/ title="Chapter 4 - Groupby and Aggregate" class=dd-item><a href=/pandas-cookbook/chapter4/>Chapter 4</a></li><li data-nav-id=/pandas-cookbook/chapter5/ title="Chapter 5 - Web scraping with Pandas" class=dd-item><a href=/pandas-cookbook/chapter5/>Chapter 5</a></li><li data-nav-id=/pandas-cookbook/chapter6/ title="Chapter 6 - String Operations" class=dd-item><a href=/pandas-cookbook/chapter6/>Chapter 6</a></li><li data-nav-id=/pandas-cookbook/chapter7/ title="Chapter 7 - Cleanup messy data" class=dd-item><a href=/pandas-cookbook/chapter7/>Chapter 7</a></li><li data-nav-id=/pandas-cookbook/chapter8/ title="Chapter 8 - Parsing Unix timestamps" class=dd-item><a href=/pandas-cookbook/chapter8/>Chapter 8</a></li></ul></li><li data-nav-id=/r/ title=R class=dd-item><a href=/r/><b></b>R</a><ul><li data-nav-id=/r/introduction/ title=Introduction class=dd-item><a href=/r/introduction/>Introduction</a></li><li data-nav-id=/r/install-env-setup/ title="Installing R and RStudio in Windows & Linux" class=dd-item><a href=/r/install-env-setup/>Installation</a></li><li data-nav-id=/r/average-mean-median-mode/ title="Calculating Average (Mean, Median, Mode) in R" class=dd-item><a href=/r/average-mean-median-mode/>Average</a></li><li data-nav-id=/r/variance/ title="Calculating Variance in R" class=dd-item><a href=/r/variance/>Variance</a></li><li data-nav-id=/r/standard-deviation/ title="Calculating Standard Deviation in R" class=dd-item><a href=/r/standard-deviation/>Standard Deviation</a></li></ul></li><li data-nav-id=/blog/ title=Blog class=dd-item><a href=/blog/><b></b>Blog</a><ul><li data-nav-id=/method-overload-vs-override-java-differences/ title="Method Overloading and Overriding in Java" class=dd-item><a href=/method-overload-vs-override-java-differences/>Overloading and Overriding Methods</a></li><li data-nav-id=/override-overload-static-method-java/ title="How to Override/Overload Static Method in Java?" class=dd-item><a href=/override-overload-static-method-java/>Override/Overload Static Method in Java</a></li><li data-nav-id=/medium-alternatives/ title="List of Medium Alternatives (self-hosted, open-source and paid)" class=dd-item><a href=/medium-alternatives/>Medium Alternatives</a></li><li data-nav-id=/machine-learning-apis-mlaas/ title="List of Machine Learning APIs on Cloud (MLaaS)" class=dd-item><a href=/machine-learning-apis-mlaas/>MLaaS</a></li><li data-nav-id=/install-deb-command-line-dpkg-apt-gdebi/ title="Install deb file from command line (dpkg, apt, gdebi, software center)" class=dd-item><a href=/install-deb-command-line-dpkg-apt-gdebi/>Install deb file from command line</a></li><li data-nav-id=/sdkman-installing-multiple-versions-java-same-machine/ title="SDKMan - Installing Multiple Versions of Java in Same Machine" class=dd-item><a href=/sdkman-installing-multiple-versions-java-same-machine/>SDKMan - Multiple Java Versions</a></li><li data-nav-id=/read-write-json-config-file-in-python/ title="Writing and Reading JSON config file in Python" class=dd-item><a href=/read-write-json-config-file-in-python/>Writing and Reading JSON config file in Python</a></li><li data-nav-id=/read-write-xml-config-file-in-python/ title="Writing and Reading XML config file in Python" class=dd-item><a href=/read-write-xml-config-file-in-python/>Writing and Reading XML config file in Python</a></li><li data-nav-id=/read-write-yaml-config-file-in-python/ title="Writing and Reading YAML config file in Python" class=dd-item><a href=/read-write-yaml-config-file-in-python/>Writing and Reading YAML config file in Python</a></li><li data-nav-id=/project-manager-must-have-skills/ title="Top 4 Must Have Skills For A Project Manager" class=dd-item><a href=/project-manager-must-have-skills/>Top 4 Must Have Skills For A Project Manager</a></li><li data-nav-id=/setup-access-questdb-python-notebook/ title="How to setup and access QuestDB using Python" class=dd-item><a href=/setup-access-questdb-python-notebook/>QuestDB in Python</a></li><li data-nav-id=/access-internet-on-linux-using-android-tethering/ title="How to access to internet on Linux using Android Tethering" class=dd-item><a href=/access-internet-on-linux-using-android-tethering/>Access internet on Linux using Android Tethering</a></li><li data-nav-id=/install-software-linux-yum-rpm-apt-dpkg/ title="How to install software in Linux (RPM/DEB systems)" class=dd-item><a href=/install-software-linux-yum-rpm-apt-dpkg/>How to install software in Linux</a></li><li data-nav-id=/read-write-config-files-in-angular/ title="Writing and Reading config files in Angular" class=dd-item><a href=/read-write-config-files-in-angular/>Writing and Reading config files in Angular</a></li><li data-nav-id=/approximating-randomness/ title="Approximating Randomness" class=dd-item><a href=/approximating-randomness/>Approximating Randomness</a></li><li data-nav-id=/convert-python-script-to-module/ title="How to convert a Python script to module" class=dd-item><a href=/convert-python-script-to-module/>How to convert a Python script to module</a></li><li data-nav-id=/grunt-tutorial-example/ title="Grunt Tutorial with Live Example" class=dd-item><a href=/grunt-tutorial-example/>Grunt Tutorial</a></li><li data-nav-id=/noprocrast/ title=noprocrast class=dd-item><a href=/noprocrast/>noprocrast</a></li><li data-nav-id=/how-to-fix-sudo-node-command-not-found-error/ title="How to fix sudo node command not found error" class=dd-item><a href=/how-to-fix-sudo-node-command-not-found-error/>sudo and node</a></li><li data-nav-id=/yet-another-lousy-monad-tutorial/ title="Yet another lousy monad tutorial" class=dd-item><a href=/yet-another-lousy-monad-tutorial/>Yet another lousy monad tutorial</a></li><li data-nav-id=/ruby-enumerable/ title="A Deeper Look at Ruby's Enumerable" class=dd-item><a href=/ruby-enumerable/>A Deeper Look at Ruby's Enumerable</a></li><li data-nav-id=/rest-api-in-clojure/ title="A REST API in Clojure" class=dd-item><a href=/rest-api-in-clojure/>A REST API in Clojure</a></li><li data-nav-id=/abstract-classes-and-interfaces-in-python/ title="Abstract classes and interfaces in Python" class=dd-item><a href=/abstract-classes-and-interfaces-in-python/>Abstract classes and interfaces in Python</a></li><li data-nav-id=/deep-learning-cardiovascular-imaging/ title="How Deep Learning Helped Reducing Variability in Cardiovascular Imaging" class=dd-item><a href=/deep-learning-cardiovascular-imaging/>Deep Learning helped reducing variability in Cardiovascular Imaging</a></li><li data-nav-id=/google-engineers-boycott-security-tool-military/ title="Google Engineers Boycott Against Security Tool for Military" class=dd-item><a href=/google-engineers-boycott-security-tool-military/>Google engineers boycott</a></li><li data-nav-id=/nodejs-google-app-engine/ title="How to deploy Node.js app on Google App Engine" class=dd-item><a href=/nodejs-google-app-engine/>Node.js on Google App Engine</a></li><li data-nav-id=/angular6-features/ title="What's new in Angular 6 (Features List)" class=dd-item><a href=/angular6-features/>Angular 6 features</a></li><li data-nav-id=/github-alternatives/ title="GitHub Alternatives (Free, Paid, Self-Hosted)" class=dd-item><a href=/github-alternatives/>Github alternatives</a></li><li data-nav-id=/what-is-the-use-of-yield-in-python/ title="What is the use of yield in Python?" class=dd-item><a href=/what-is-the-use-of-yield-in-python/>What is the use of yield in Python?</a></li><li data-nav-id=/append-vs-extend-python/ title="Difference between append and extend in Python" class=dd-item><a href=/append-vs-extend-python/>Difference between append and extend in Python</a></li><li data-nav-id=/print-same-line-python/ title="How to print on same line with print in Python" class=dd-item><a href=/print-same-line-python/>How to print on same line with print in Python</a></li><li data-nav-id=/read-write-config-files-in-python/ title="Writing and Reading config files in Python" class=dd-item><a href=/read-write-config-files-in-python/>Writing and Reading config files in Python</a></li><li data-nav-id=/run-module-as-script-python/ title="How to run a Python module as script?" class=dd-item><a href=/run-module-as-script-python/>How to run a Python module as script?</a></li><li data-nav-id=/if-name-main-in-python/ title='What is if __name__ == "__main__" in Python?' class=dd-item><a href=/if-name-main-in-python/>What is if __name__ == "__main__" in Python?</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://tutswiki.com/tags/><i class="fas fa-tags"></i>Tags</a></li><li><a class=padding href=https://github.com/TutsWiki/source/><i class="fab fa-fw fa-github"></i>GitHub</a></li><li><a class=padding href=https://github.com/TutsWiki/source/graphs/contributors/><i class="fa fa-fw fa-bullhorn"></i>Credits</a></li><li><a class=padding href=https://www.facebook.com/TutsWiki/><i class="fab fa-fw fa-facebook"></i>Facebook</a></li></ul></section><section id=footer><center><a class=github-button href=https://github.com/TutsWiki/source/ data-icon=octicon-star data-show-count=true aria-label="Star TutsWiki/source on GitHub">Star</a>
<a class=github-button href=https://github.com/TutsWiki/source/fork data-icon=octicon-repo-forked data-show-count=true aria-label="Fork TutsWiki/source on GitHub">Fork</a><p>Built by Community with <a href=https://github.com/TutsWiki/source/graphs/contributors><i class="fa fa-heart"></i></a></center><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/TutsWiki/source/edit/master/content/ml/decision-trees.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/>TutsWiki Beta</a> > <a href=/ml/>Machine Learning</a> > An insight to Decision Trees</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a></li><li><a href=#types-of-decision-trees>Types of Decision Trees</a></li><li><a href=#decision-tree-for-regression>Decision Tree for Regression</a></li><li><a href=#building-regression-tree>Building Regression Tree</a></li><li><a href=#prune-regression-trees>Prune Regression Trees</a></li><li><a href=#decision-trees-for-classification>Decision Trees for Classification</a></li><li><a href=#calculating-impurity>Calculating Impurity</a></li><li><a href=#disadvantages-limitations-of-decision-trees>Disadvantages/Limitations of Decision Trees</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/tags/ml>ML</a></div></div><div id=body-inner><h1>An insight to Decision Trees</h1><p><meta property="og:image" content="https://tutswiki.com/images/ml/info-gain.png"><meta name=twitter:card content="summary"><meta name=twitter:title content="Decision Trees"><meta name=”twitter:description” content="Decision trees are supervised learning models utilized for regression and classification. It uses a single tree that can be visualized so we can see the root, sub-roots, leaves, and the way the Tree has decided to predict/classify its final output gives decision trees high interpretability."></p><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><h2 id=introduction>Introduction</h2><p>Decision trees are supervised learning models utilized for regression and classification. It uses a single tree that can be visualized so we can see the root, sub-roots, leaves, and the way the Tree has decided to predict/classify its final output gives decision trees high interpretability.</p><h2 id=types-of-decision-trees>Types of Decision Trees</h2><p>There are two varieties of Decision Trees based on the dependent variable:</p><ol><li><code>Decision Tree Classifier</code>: Here, the dependent feature is categorical, for instance, Diabetic and Non-Diabetic Patient, Fraudulent and non-fraudulent transactions.</li><li><code>Decision Tree Regressor</code>: Here, the dependent feature is continuous like the income of a person, the percentage of effectiveness of a medicine.</li></ol><h2 id=decision-tree-for-regression>Decision Tree for Regression</h2><p>Decision trees where continuous values (typically real numbers) can be taken by the target variable are called regression trees. Via a process known as binary recursive partitioning, a regression tree is created, which is an iterative process that divides the data into partitions or divisions and then divides each section into smaller groups as each branch is moved by the system.</p><p>Suppose you have to predict the percentage of vitamin supplement effectiveness for a person based on the dosage, but the data when visualized shows that low dosages are not that significant, moderate are compelling up to 70%, somewhat higher are up to 50%, but very high dosages are not effective at all. We can&rsquo;t fit a straight line in this case.</p><p>So one approach can be to fit a decision tree to this data, in this case, a regression-based tree.</p><h2 id=building-regression-tree>Building Regression Tree</h2><p>To select the root of the Tree, we try different threshold values based on the average of the data points(e.g., Dosage&lt;14, Dosage&lt;30, and so on.). We select the threshold, which gives the minimum sum of squared Residual difference (sum of the square of the difference between actual and predicted values) SSR as we can use the residuals to quantify the quality of the predictions.</p><p>In this way, we split the data in a way that reduces variance as we want homogeneous points in one leaf. We calculate the sum of squared residuals to decide the sub-roots similarly. It stops splitting when it has no more scope to reduce variance, but in real-world problems, we set the parameters and control the max_depth, min_samples_split, min_samples_leaf, etc. to make it robust as it needs to generalize better to be able to predict new data points.</p><h2 id=prune-regression-trees>Prune Regression Trees</h2><p>To reduce overfitting, we use pruning.</p><ul><li><code>Cost-complexity Pruning</code>: If we only use SSR to select the best Tree, the Tree will end up overfitting, so one way is to calculate the tree score, which takes no. of leaves into consideration while selecting the Tree.</li><li><code>Weakest Link Pruning</code>: <strong>Tree Score = SSR + alpha*(Terminal nodes)</strong> The tree complexity parameter(alpha) compensates for the difference in the no. of leaves, which is a more robust way to evaluate the score. Alpha is a tuning parameter which we can find cross-validation.</li></ul><h2 id=decision-trees-for-classification>Decision Trees for Classification</h2><p>Decision trees where the target variable is categorical are called classification trees. Suppose we want to classify if the person has diabetes or not. We have multiple features like Glucose, Blocked Arteries, Insulin, Skin Thickness, BMI, Age, etc. So want to use a decision tree for classification, how does it work? The Tree has three node types:</p><ol><li><code>Root node</code>: There are no incoming edges and zero outgoing edges or more.</li><li><code>Internal nodes</code>: They have precisely one inbound edge and two outbound edges or more.</li><li><code>Leaf or terminal nodes</code>: Precisely one incoming edge and no outgoing edges are possible.</li></ol><p>First, it decides the primary root node. How? It starts by looking at how well feature 1 (Glucose) alone predicts! It will look at how well glucose separated patients with and without diabetes. It will do this process for all the features. And every Tree will have leaves which will have some no. of diabetic and some no. of non-diabetic people, for, e.g., if Age>50 has x no. of people diabetic people there might be y no. of people who do not have diabetes.</p><p>When none of the leaves is 100%, Yes or No, they are all considered impure. To determine which separation is best, we need a way to calculate the impurity index to measure and compare impurity.</p><h2 id=calculating-impurity>Calculating Impurity</h2><p>There are many ways to calculate impurity</p><ul><li>$$Entropy = \sum p_{j}log _{2} p _{j}$$</li><li>$$Gini Index = 1 - \sum p _{j}2$$</li><li>$$Classification Error = 1 - max(p _{j})$$</li></ul><p>For the above example, let us choose the Gini Index to calculate impurity.
For a leaf, the Gini Impurity =</p><p><strong>1 - (probability of diabetic person)<sup>2</sup> - (probability of non diabetic person)<sup>2</sup></strong></p><p>Gini Impurity for Glucose as root node= Weighted average of Gini Impurities of the leaf nodes.</p><p>It calculates Gini impurity for every feature (where it as root), and then the feature with the lowest Gini impurity will be used as the root of the Tree. There will be further partitioning as the nodes are not 100% pure. So for finding
sub-roots, it will again follow the same process.</p><p>Further, if the node itself seems to have the lowest score, then also partitioning is futile, and it becomes a leaf node. But if the segregation of the data results in the Gini score change, then the separation with the least level is picked.</p><ul><li>When the features are numeric like BMI:<ul><li>Step 1: Sort the patients in ascending order.</li><li>Step 2: Calculate the average BMI for all adjacent patients.</li><li>Step 3: Calculate the impurity values for each average BMI.
It will select the BMI value when the lowest impurity occurs.</li></ul></li><li>When a feature is of ranked data form: It is similar to numeric data but here impurity score is calculated for every rank.</li></ul><p><img src=/images/ml/info-gain.png alt="Information Gain" title="Information Gain"></p><p>Information Gain should be highest when splitting the data.</p><h2 id=disadvantages-limitations-of-decision-trees>Disadvantages/Limitations of Decision Trees</h2><ol><li>Locally greedy, tree splitting: The Tree looks for a binary division at each step so that the impurity of the Tree is reduced by the maximum number. It&rsquo;s a greedy algorithm that hits the local optimum. For example, it may be likely to benefit less than the maximum decrease in impurity at the current level to achieve the lowest possible impurity of the final Tree, but the algorithm for tree splitting can not consider any more than the current level. This implies that the formulated Decision Tree is usually optimal locally and not optimal globally.</li><li>An optimal decision tree seems to be an NP-complete problem: The total number of trees from the same input dataset is exceedingly high because of the number of feature variables, the inherent abundance of split points, and the high depth of the Tree. Thus, not only is tree division, not global, but it is also virtually impossible to compute the ideal Tree globally.</li><li>Overfitting: Decision trees tend to overfit, which makes them less robust as they are sensitive and prone to sampling errors. It can be reduced by hyperparameter tuning like by setting the max-depth, min samples split, min samples leaf, max-leaf nodes, min impurity split. We can tune it using GridSearchCV and cross-validation and by evaluating different classification metrics to make it robust.</li></ol><footer class=footline></footer><div class="notices note"><p>Help us improve this content by
<a class=github-link title="editing this page on GitHub" href=https://github.com/TutsWiki/source/edit/master/content/ml/decision-trees.md target=blank><span id=top-github-link-text>editing this page on GitHub </span><i class="fas fa-code-branch"></i></a></p></div></div></div><div id=navigation><a class="nav nav-prev" href=/ml/ title="Machine Learning"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/cplusplus/ title=C++ style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1605243543></script><script src=/js/perfect-scrollbar.min.js?1605243543></script><script src=/js/perfect-scrollbar.jquery.min.js?1605243543></script><script src=/js/jquery.sticky.js?1605243543></script><script src=/js/featherlight.min.js?1605243543></script><script src=/js/highlight.pack.js?1605243543></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js?1605243543></script><script src=/js/learn.js?1605243543></script><script src=/js/hugo-learn.js?1605243543></script><link href=/mermaid/mermaid.css?1605243543 rel=stylesheet><script src=/mermaid/mermaid.js?1605243543></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>