<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="pandas, parsing time, timestamp, unix timestamp, datetime">
    <meta name="description" content="Parsing Unix timestamps">
    <meta name="author" content="Chankey Pathak (@chankeypathak)">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <title>Chapter 8 - Parsing Unix timestamps</title>
    <link href="/css/bootstrap-theme.css" rel="stylesheet">
    <link href="/assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/style-responsive.css" rel="stylesheet" />
    <link href="/css/monokai_sublime.css" rel="stylesheet" />

  </head>

  <body>
  
  <section id="container" class="">

      
      <header class="header black-bg">
            <div class="toggle-nav">
                <i class="fa fa-bars"></i>
                <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
            </div>

            
            <a href="/" class="logo"><img src="/img/tutswiki-logo.png" style="height: 40px; vertical-align: bottom;"></a>
            
            <div class="top-nav notification-row">
                
                <div class="hidden-xs nav-github pull-right">
                    <span rel="show-github" data-user="chankeypathak" data-repo="hugo" data-type="follow"></span>
                    <span rel="show-github" data-user="tutswiki" data-repo="source"></span>
                    <span rel="show-github" data-user="tutswiki" data-repo="source" data-type="fork"></span>
                </div>
            </div>

            <div class="nav title-row" id="top_menu">
                <h1 class="nav top-menu">Chapter 8 - Parsing Unix timestamps</h1>
            </div>
      </header>
      


<aside>
    <div id="sidebar" class="nav-collapse">
        
        <ul class="sidebar-menu">
          
          
              

            <li class="sub-menu active">
            <a href="javascript:;" class="">
                
                
                <span>Pandas Cookbook</span>
                <span class="menu-arrow fa fa-angle-down"></span>
            </a>
                <ul class="sub open">
                    
                    <li><a href="/pandas-cookbook/chapter1">Chapter 1</a> </li>
                    
                    <li><a href="/pandas-cookbook/chapter2">Chapter 2</a> </li>
                    
                    <li><a href="/pandas-cookbook/chapter3">Chapter 3</a> </li>
                    
                    <li><a href="/pandas-cookbook/chapter4">Chapter 4</a> </li>
                    
                    <li><a href="/pandas-cookbook/chapter5">Chapter 5</a> </li>
                    
                    <li><a href="/pandas-cookbook/chapter6">Chapter 6</a> </li>
                    
                    <li><a href="/pandas-cookbook/chapter7">Chapter 7</a> </li>
                    
                    <li class="active"><a href="/pandas-cookbook/chapter8">Chapter 8</a> </li>
                    
                </ul>
              
              </li>
          
            <li> <a href="https://github.com/TutsWiki/source/issues" target="blank"><i class='fa fa-life-ring'></i> <span>Issues & Help</span></a> </li>
            
              <li><a href="https://github.com/TutsWiki/source/edit/master/content/tutorials/pandas%20cookbook/chapter8.md" target="blank"><i class='fa fa-edit'></i> Refine this Page</a> </li>
            
        </ul>
        
    </div>
</aside>



      
      <section id="main-content">
          <section class="wrapper">

              
                  
                      
                      
                          
                          
                          
                      
                      
                  
              

              <div class="row">
                  <div class="col-md-1">
                      
                      
                      <a class="navigation prev" href="/pandas-cookbook/chapter7">
                      <i class="fa fa-angle-left"></i>
                      </a>
                      
                      
                  </div>
                <div class="col-md-10">
                    <section class="panel">
                          
                              
                          
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-lg-12 cse">
                                
                            </div>
                        </div>




<h2 id="8-1-parsing-unix-timestamps">8.1 Parsing Unix timestamps</h2>

<p>It&rsquo;s not obvious how to deal with Unix timestamps in pandas &ndash; it took me quite a while to figure this out. The file we&rsquo;re using here is a popularity-contest file I found on my system at <a href="/popularity-contest">/var/log/popularity-contest</a>.</p>

<p>Here&rsquo;s an <a href="http://popcon.ubuntu.com/README">explanation of how this file works</a>.</p>

<p>I&rsquo;m going to hope that nothing in it is sensitive :)</p>

<pre><code class="language-python">import pandas as pd
# Read it, and remove the last row
popcon = pd.read_csv('popularity-contest', sep=' ', )[:-1]
popcon.columns = ['atime', 'ctime', 'package-name', 'mru-program', 'tag']
popcon[:5]
</code></pre>

<p>The colums are the access time, created time, package name, recently used program, and a tag</p>

<p>Output:</p>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>atime</th>
      <th>ctime</th>
      <th>package-name</th>
      <th>mru-program</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 1387295797</td>
      <td> 1367633260</td>
      <td>    perl-base</td>
      <td>                                /usr/bin/perl</td>
      <td>            NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 1387295796</td>
      <td> 1354370480</td>
      <td>        login</td>
      <td>                                      /bin/su</td>
      <td>            NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 1387295743</td>
      <td> 1354341275</td>
      <td>   libtalloc2</td>
      <td> /usr/lib/x86_64-linux-gnu/libtalloc.so.2.0.7</td>
      <td>            NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 1387295743</td>
      <td> 1387224204</td>
      <td> libwbclient0</td>
      <td>   /usr/lib/x86_64-linux-gnu/libwbclient.so.0</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td> 1387295742</td>
      <td> 1354341253</td>
      <td>  libselinux1</td>
      <td>        /lib/x86_64-linux-gnu/libselinux.so.1</td>
      <td>            NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<p>The magical part about parsing timestamps in pandas is that numpy datetimes are already stored as Unix timestamps. So all we need to do is tell pandas that these integers are actually datetimes &ndash; it doesn&rsquo;t need to do any conversion at all.</p>

<p>We need to convert these to ints to start:</p>

<pre><code class="language-python">popcon['atime'] = popcon['atime'].astype(int)
popcon['ctime'] = popcon['ctime'].astype(int)
</code></pre>

<p>Every numpy array and pandas series has a dtype &ndash; this is usually int64, float64, or object. Some of the time types available are datetime64[s], datetime64[ms], and datetime64[us]. There are also timedelta types, similarly.</p>

<p>We can use the <a href="http://pandas.pydata.org/pandas-docs/version/0.20/generated/pandas.to_datetime.html">pd.to_datetime</a> function to convert our integer timestamps into datetimes. This is a constant-time operation &ndash; we&rsquo;re not actually changing any of the data, just how pandas thinks about it.</p>

<pre><code class="language-python">popcon['atime'] = pd.to_datetime(popcon['atime'], unit='s')
popcon['ctime'] = pd.to_datetime(popcon['ctime'], unit='s')
popcon['atime'].dtype
</code></pre>

<p>Output:</p>

<pre><code class="language-bash">dtype('&lt;M8[ns]')
</code></pre>

<p>If we look at the dtype now, it&rsquo;s &lt;M8[ns]. As far as I can tell M8 is secret code for datetime64.</p>

<p>So now we can look at our atime and ctime as dates!</p>

<pre><code class="language-python">popcon[:5]
</code></pre>

<p>Output:</p>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>atime</th>
      <th>ctime</th>
      <th>package-name</th>
      <th>mru-program</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2013-12-17 15:56:37</td>
      <td>2013-05-04 02:07:40</td>
      <td>    perl-base</td>
      <td>                                /usr/bin/perl</td>
      <td>            NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2013-12-17 15:56:36</td>
      <td>2012-12-01 14:01:20</td>
      <td>        login</td>
      <td>                                      /bin/su</td>
      <td>            NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013-12-17 15:55:43</td>
      <td>2012-12-01 05:54:35</td>
      <td>   libtalloc2</td>
      <td> /usr/lib/x86_64-linux-gnu/libtalloc.so.2.0.7</td>
      <td>            NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2013-12-17 15:55:43</td>
      <td>2013-12-16 20:03:24</td>
      <td> libwbclient0</td>
      <td>   /usr/lib/x86_64-linux-gnu/libwbclient.so.0</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-12-17 15:55:42</td>
      <td>2012-12-01 05:54:13</td>
      <td>  libselinux1</td>
      <td>        /lib/x86_64-linux-gnu/libselinux.so.1</td>
      <td>            NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<p>Now suppose we want to look at all packages that aren&rsquo;t libraries.</p>

<p>First, I want to get rid of everything with timestamp 0. Notice how we can just use a string in this comparison, even though it&rsquo;s actually a timestamp on the inside? That is because pandas is amazing.</p>

<pre><code class="language-python">popcon = popcon[popcon['atime'] &gt; '1970-01-01']
</code></pre>

<p>Now we can use pandas&rsquo; magical string abilities to just look at rows where the package name doesn&rsquo;t contain &lsquo;lib&rsquo;.</p>

<pre><code class="language-python">nonlibraries = popcon[~popcon['package-name'].str.contains('lib')]
nonlibraries.sort('ctime', ascending=False)[:10]
</code></pre>

<p>Output:</p>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>atime</th>
      <th>ctime</th>
      <th>package-name</th>
      <th>mru-program</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>57 </th>
      <td>2013-12-17 04:55:39</td>
      <td>2013-12-17 04:55:42</td>
      <td>                       ddd</td>
      <td>                                      /usr/bin/ddd</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>450</th>
      <td>2013-12-16 20:03:20</td>
      <td>2013-12-16 20:05:13</td>
      <td>                    nodejs</td>
      <td>                                      /usr/bin/npm</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>454</th>
      <td>2013-12-16 20:03:20</td>
      <td>2013-12-16 20:05:04</td>
      <td> switchboard-plug-keyboard</td>
      <td>      /usr/lib/plugs/pantheon/keyboard/options.txt</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>445</th>
      <td>2013-12-16 20:03:20</td>
      <td>2013-12-16 20:05:04</td>
      <td>     thunderbird-locale-en</td>
      <td> /usr/lib/thunderbird-addons/extensions/langpac...</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>396</th>
      <td>2013-12-16 20:08:27</td>
      <td>2013-12-16 20:05:03</td>
      <td>           software-center</td>
      <td>                  /usr/sbin/update-software-center</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>449</th>
      <td>2013-12-16 20:03:20</td>
      <td>2013-12-16 20:05:00</td>
      <td>          samba-common-bin</td>
      <td>                               /usr/bin/net.samba3</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>397</th>
      <td>2013-12-16 20:08:25</td>
      <td>2013-12-16 20:04:59</td>
      <td>     postgresql-client-9.1</td>
      <td>                  /usr/lib/postgresql/9.1/bin/psql</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>398</th>
      <td>2013-12-16 20:08:23</td>
      <td>2013-12-16 20:04:58</td>
      <td>            postgresql-9.1</td>
      <td>            /usr/lib/postgresql/9.1/bin/postmaster</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>452</th>
      <td>2013-12-16 20:03:20</td>
      <td>2013-12-16 20:04:55</td>
      <td>                  php5-dev</td>
      <td>                 /usr/include/php5/main/snprintf.h</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
    <tr>
      <th>440</th>
      <td>2013-12-16 20:03:20</td>
      <td>2013-12-16 20:04:54</td>
      <td>                  php-pear</td>
      <td>                       /usr/share/php/XML/Util.php</td>
      <td> &lt;RECENT-CTIME&gt;</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<p>Okay, cool, it says that I I installed ddd recently. And postgresql! I remember installing those things. Neat.</p>

<p>The whole message here is that if you have a timestamp in seconds or milliseconds or nanoseconds, then you can just &ldquo;cast&rdquo; it to a <code>datetime64[the-right-thing]</code> and pandas/numpy will take care of the rest.</p>



                    </div>
                    </section>
                    <div style="font-size: medium; font-style: italic; text-align: right;">
                      <span style="font-size: medium; font-style: italic; text-align: left;">Last revision: May 18, 2017</span>
                    </div>

                    </div>

                <div class="col-md-1">
                    
                    
                    
                </div>
              </div>
              
          </section>
      </section>
     
  </section>
  
    
    <script src="/js/jquery-2.1.1.min.js"></script>
    <script src="/js/jquery.scrollTo.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/scripts.js"></script>
    <script async defer id="github-bjs" src="/js/buttons.js"></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-12858299-25', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>

