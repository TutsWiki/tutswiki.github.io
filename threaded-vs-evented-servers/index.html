<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.69.2" />
    <meta name="description" content="Threaded servers use multiple concurrently-executing threads that each handle one client request, while evented servers run a single event loop that handles events for all connected clients.">
	<meta name="author" content="Chankey Pathak">
	<meta name="keywords" content="clojure,deploy,develop,programming,webapp,aws,ec2">
    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />
	<meta property="og:title" content="Threaded vs Evented Servers" />
	<meta property="og:description" content="Threaded servers use multiple concurrently-executing threads that each handle one client request, while evented servers run a single event loop that handles events for all connected clients." />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="http://tutswiki.com/threaded-vs-evented-servers/" />
	<meta property="og:locale" content="en" />
    <title>Threaded vs Evented Servers - TutsWiki Beta</title>
    
    
    <link href="/css/nucleus.css?1595681594" rel="stylesheet">
    <link href="/css/font-awesome.min.css?1595681594" rel="stylesheet">
    <link href="/css/hybrid.css?1595681594" rel="stylesheet">
    <link href="/css/featherlight.min.css?1595681594" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1595681594" rel="stylesheet">
    <link href="/css/auto-complete.css?1595681594" rel="stylesheet">
    <link href="/css/theme.css?1595681594" rel="stylesheet">
    <link href="/css/hugo-theme.css?1595681594" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1595681594"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-12858299-25"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12858299-25');
</script>

  </head>
  <body class="" data-url="/threaded-vs-evented-servers/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/"><img src="https://tutswiki.com/img/tutswiki-logo.png" style="width:70%"/></a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1595681594"></script>
<script type="text/javascript" src="/js/auto-complete.js?1595681594"></script>
<script type="text/javascript">
    
        var baseurl = '\/';
    
</script>
<script type="text/javascript" src="/js/search.js?1595681594"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/blog/" title="Blog" class="dd-item 
        parent
        
        
        ">
      <a href="/blog/">
          <b></b>Blog
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/developing-and-deploying-clojure-web-application-aws" title="Developing a Simple Clojure Web Application and Deploying to AWS" class="dd-item ">
        <a href="/developing-and-deploying-clojure-web-application-aws/">
        Developing a Simple Clojure Web Application and Deploying to AWS
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/threaded-vs-evented-servers" title="Threaded vs Evented Servers" class="dd-item active">
        <a href="/threaded-vs-evented-servers/">
        Threaded vs Evented Servers
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/environment-passing-in-clojure" title="Environment Passing in Clojure" class="dd-item ">
        <a href="/environment-passing-in-clojure/">
        Environment Passing in Clojure
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/how-to-fix-sudo-node-command-not-found-error" title="How to fix sudo node command not found error" class="dd-item ">
        <a href="/how-to-fix-sudo-node-command-not-found-error/">
        sudo and node
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/yet-another-lousy-monad-tutorial" title="Yet another lousy monad tutorial" class="dd-item ">
        <a href="/yet-another-lousy-monad-tutorial/">
        Yet another lousy monad tutorial
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/ruby-enumerable" title="A Deeper Look at Ruby&#39;s Enumerable" class="dd-item ">
        <a href="/ruby-enumerable/">
        A Deeper Look at Ruby&#39;s Enumerable
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rest-api-in-clojure" title="A REST API in Clojure" class="dd-item ">
        <a href="/rest-api-in-clojure/">
        A REST API in Clojure
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/abstract-classes-and-interfaces-in-python" title="Abstract classes and interfaces in Python" class="dd-item ">
        <a href="/abstract-classes-and-interfaces-in-python/">
        Abstract classes and interfaces in Python
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/deep-learning-cardiovascular-imaging" title="How Deep Learning Helped Reducing Variability in Cardiovascular Imaging" class="dd-item ">
        <a href="/deep-learning-cardiovascular-imaging/">
        Deep Learning helped reducing variability in Cardiovascular Imaging
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/google-engineers-boycott-security-tool-military" title="Google Engineers Boycott Against Security Tool for Military" class="dd-item ">
        <a href="/google-engineers-boycott-security-tool-military/">
        Google engineers boycott
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/nodejs-google-app-engine" title="How to deploy Node.js app on Google App Engine" class="dd-item ">
        <a href="/nodejs-google-app-engine/">
        Node.js on Google App Engine
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/angular6-features" title="What&#39;s new in Angular 6 (Features List)" class="dd-item ">
        <a href="/angular6-features/">
        Angular 6 features
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/github-alternatives" title="GitHub Alternatives (Free, Paid, Self-Hosted)" class="dd-item ">
        <a href="/github-alternatives/">
        Github alternatives
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/what-is-the-use-of-yield-in-python" title="What is the use of yield in Python?" class="dd-item ">
        <a href="/what-is-the-use-of-yield-in-python/">
        What is the use of yield in Python?
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/append-vs-extend-python" title="Difference between append and extend in Python" class="dd-item ">
        <a href="/append-vs-extend-python/">
        Difference between append and extend in Python
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/print-same-line-python" title="How to print on same line with print in Python" class="dd-item ">
        <a href="/print-same-line-python/">
        How to print on same line with print in Python
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/read-write-config-files-in-python" title="Writing and Reading config files in Python" class="dd-item ">
        <a href="/read-write-config-files-in-python/">
        Writing and Reading config files in Python
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/run-module-as-script-python" title="How to run a Python module as script?" class="dd-item ">
        <a href="/run-module-as-script-python/">
        How to run a Python module as script?
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/if-name-main-in-python" title="What is if __name__ == &#34;__main__&#34; in Python?" class="dd-item ">
        <a href="/if-name-main-in-python/">
        What is if __name__ == &#34;__main__&#34; in Python?
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pandas-cookbook/" title="Pandas Cookbook" class="dd-item 
        
        
        
        ">
      <a href="/pandas-cookbook/">
          <b></b>Pandas Cookbook
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pandas-cookbook/chapter1" title="Chapter 1 - Reading from a CSV" class="dd-item ">
        <a href="/pandas-cookbook/chapter1/">
        Chapter 1
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pandas-cookbook/chapter2" title="Chapter 2 - Selecting and finding desired data" class="dd-item ">
        <a href="/pandas-cookbook/chapter2/">
        Chapter 2
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pandas-cookbook/chapter3" title="Chapter 3 - Filtering dataframes" class="dd-item ">
        <a href="/pandas-cookbook/chapter3/">
        Chapter 3
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pandas-cookbook/chapter4" title="Chapter 4 - Groupby and Aggregate" class="dd-item ">
        <a href="/pandas-cookbook/chapter4/">
        Chapter 4
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pandas-cookbook/chapter5" title="Chapter 5 - Web scraping with Pandas" class="dd-item ">
        <a href="/pandas-cookbook/chapter5/">
        Chapter 5
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pandas-cookbook/chapter6" title="Chapter 6 - String Operations" class="dd-item ">
        <a href="/pandas-cookbook/chapter6/">
        Chapter 6
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pandas-cookbook/chapter7" title="Chapter 7 - Cleanup messy data" class="dd-item ">
        <a href="/pandas-cookbook/chapter7/">
        Chapter 7
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pandas-cookbook/chapter8" title="Chapter 8 - Parsing Unix timestamps" class="dd-item ">
        <a href="/pandas-cookbook/chapter8/">
        Chapter 8
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/TutsWiki/source/"><i class='fa fa-fw fa-github'></i> Github repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/TutsWiki/source/graphs/contributors"><i class='fa fa-fw fa-bullhorn'></i> Credits</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/TutsWiki/"><i class='fa fa-fw fa-facebook'></i> Facebook</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <center>
    
    <a class="github-button" href="https://github.com/TutsWiki/source/" data-icon="octicon-star" data-show-count="true" aria-label="Star TutsWiki/source on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/TutsWiki/source/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork TutsWiki/source on GitHub">Fork</a>

    <p>Built by Community with <a href="https://github.com/TutsWiki/source/graphs/contributors"><i class="fa fa-heart"></i></a>
</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/TutsWiki/source/edit/master/content/blog/threaded-vs-evented-servers.md" target="blank">
                      <i class="fa fa-code-fork"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>TutsWiki Beta</a> > <a href='/blog/'>Blog</a> > Threaded vs Evented Servers
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">

    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Threaded vs Evented Servers</h1>
          

        


<p><meta property="og:image" content="https://tutswiki.com/img/tutswiki-logo.png"/>
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Threaded vs Evented Servers" />
<meta name=”twitter:description” content="Threaded servers use multiple concurrently-executing threads that each handle one client request, while evented servers run a single event loop that handles events for all connected clients." /></p>

<p>Broadly speaking, there are two ways to handle concurrent requests to a server. <em>Threaded</em> servers use multiple concurrently-executing threads that each handle one client request, while <em>evented</em> servers run a single event loop that handles events for all connected clients.</p>

<p>To chose between the threaded and evented approaches you need to consider the load profile of the server. This post describes a simple mathematical model for reasoning about these load profiles and their implications for server design.</p>

<p>Suppose that requests to a server take <code>c</code> CPU milliseconds and w wall clock milliseconds to execute. The CPU time is spent actively computing on behalf of the request, while the wall clock time is the total time including that time spent waiting for calls to external resources. For example, a web application request might take 5 ms of CPU time <code>c</code> and 95 ms waiting for a database call for a total wall time <code>w</code> of 100 ms. Let’s also say that a threaded version of the server can maintain up to <code>t</code> threads before performance degrades because of scheduling and context-switching overhead. Finally, we’ll assume single-core servers.</p>

<p>If a server is CPU bound then it will be able to respond to at most</p>
<pre><code>(/ 1000 c)</code></pre>
<p>requests per second. For example, if each requests takes 2 ms of CPU time then the CPU can only handle</p>
<pre><code>(/ 1000 2)
=&gt; 500</code></pre>
<p>requests per second.</p>

<p>If the server is thread bound then it can handle at most</p>
<pre><code>(* t (/ 1000 w))</code></pre>
<p>requests per second. This expression is similar to the one for CPU time, but here we multiply the result by <code>t</code> to account for the <code>t</code> concurrent threads.</p>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9878675755379402"
     data-ad-slot="5842766387"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p>The throughput of a threaded server is the minimum of the CPU and thread bounds since it is subject to both constraints. An evented server is not subject to the thread constraint since it only uses one thread; its throughput is given by the CPU bound. We can express this as follows:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#66d9ef">defn </span>max-request-rate [t c w]
  (<span style="color:#66d9ef">let </span>[cpu-bound    (/ <span style="color:#ae81ff">1000</span> c)
        thread-bound (* t (/ <span style="color:#ae81ff">1000</span> w))]
    {<span style="color:#e6db74">:threaded</span> (min cpu-bound thread-bound)
     <span style="color:#e6db74">:evented</span>  cpu-bound}))</code></pre></div>
<p>Now we&rsquo;ll consider some different types of servers and see how they might perform with threaded and evented implementations.</p>

<p>For the examples below I&rsquo;ll use a <code>t</code> value of 25. This is a modest number of threads that most threading implementations can handle.</p>

<p>Let&rsquo;s start with a classic example: an HTTP proxy server. These servers require very little CPU time, so say <code>c</code> is 0.1 ms. Suppose that the downstream servers can receive the relay within milliseconds for a wall time <code>w</code> of, say, 10 ms. Then we have</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#a6e22e">max-request-rate</span> <span style="color:#ae81ff">25</span> <span style="color:#ae81ff">0.1</span> <span style="color:#ae81ff">10</span>)
=&gt; {<span style="color:#e6db74">:threaded</span> <span style="color:#ae81ff">2500</span>, <span style="color:#e6db74">:evented</span> <span style="color:#ae81ff">10000</span>}</code></pre></div>
<p>In this case we expect a threaded server to be able to handle 2500 requests per second and an evented server 10000 requests per second. The higher performance of the evented server implies that the thread bound is limiting for the threaded server.</p>

<p>Another familiar example is the web application server. Let&rsquo;s first consider the case where we have a lightweight app that does not access any external resources. In this case the request parsing and response generation might take a few milliseconds; say <code>c</code> is 2 ms. Since no blocking calls are made this is the value of <code>w</code> as well. Then</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#a6e22e">max-request-rate</span> <span style="color:#ae81ff">25</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">2</span>)
=&gt; {<span style="color:#e6db74">:threaded</span> <span style="color:#ae81ff">500</span>, <span style="color:#e6db74">:evented</span> <span style="color:#ae81ff">500</span>}</code></pre></div>
<p>Here the threaded server performs as well as the evented server because the workload is CPU bound.</p>

<p>Suppose we have a more heavyweight app that is making calls to external resources like the filesystem and database. In this case the amount of CPU time will be somewhat larger that the previous case but still modest; say <code>c</code> is 5 ms. But now that we are waiting on external resources we should expect a <code>w</code> value of, say, 100 ms. Then we have</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#a6e22e">max-request-rate</span> <span style="color:#ae81ff">25</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">100</span>)
=&gt; {<span style="color:#e6db74">:threaded</span> <span style="color:#ae81ff">200</span>, <span style="color:#e6db74">:evented</span> <span style="color:#ae81ff">200</span>}</code></pre></div>
<p>Even though we are making a lot of blocking calls, the workload is still CPU bound and the threaded and evented servers will therefore perform comparably.</p>

<p>Suppose now that we are implementing a background service such as an RSS feed fetcher that makes high-latency requests to external services and then performs minimal processing of the results. In this case <code>c</code> may be quite low, say 2 ms, but <code>w</code> will be high, say 250 ms. Then</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#a6e22e">max-request-rate</span> <span style="color:#ae81ff">25</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">250</span>)
=&gt; {<span style="color:#e6db74">:threaded</span> <span style="color:#ae81ff">100</span>, <span style="color:#e6db74">:evented</span> <span style="color:#ae81ff">500</span>}</code></pre></div>
<p>Here an evented server will perform better. The CPU load is sufficiently low and the external resource latency sufficiently high that the blocking external calls limit the threaded implementation.</p>

<p>Finally, consider the case of long polling clients. Here clients establish a connection to the server and the server responds only when it has a message it wants to send to the client. Suppose that we have a lightweight app such that <code>c</code> is 1 ms, but that response messages are sent to the client after 10 seconds such that the <code>w</code> value is 10000 ms. Then</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#a6e22e">max-request-rate</span> <span style="color:#ae81ff">25</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">10000</span>)
=&gt; {<span style="color:#e6db74">:threaded</span> <span style="color:#ae81ff">2.5</span>, <span style="color:#e6db74">:evented</span> <span style="color:#ae81ff">1000</span>}</code></pre></div>
<p>If the server were really limited to 25 threads and each client required its own thread, we could only allow 2.5 new connections per second if we wanted to avoid exceeding the thread allocation. An evented server on the other hand could saturate the CPU by accepting 1000 requests per second.</p>

<p>Even if we increase the maximum number of threads <code>t</code> by an order of magnitude to 250, the evented approach still fares better:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#a6e22e">max-request-rate</span> <span style="color:#ae81ff">250</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">10000</span>)
=&gt; {<span style="color:#e6db74">:threaded</span> <span style="color:#ae81ff">25</span>, <span style="color:#e6db74">:evented</span> <span style="color:#ae81ff">1000</span>}</code></pre></div>
<p>Indeed, a threaded server would need to maintain 10000 threads in order to be able to accept requests at the rate of the evented server.</p>

<p>Now that we have seen some specific examples of the model we should step back and note the patterns. In general, an evented architecture becomes more favorable as the ratio of wall time <code>w</code> to CPU time <code>c</code> increases, i.e. as proportionally more time is spent waiting on external resources. Also, the viability of a threaded architecture depends on the strength of the underlying threading implementation; the higher the thread threshold <code>t</code>, the more wait time can be tolerated before eventing becomes necessary.</p>

<p>In addition to the quantitative performance implications captured by this model, there are several qualitative factors that influence the suitability of threaded and evented architectures for particular servers.</p>

<p>One factor is the fit of the server architecture to the work that the server is doing internally. For example, proxying is well suited to evented architectures because the work being done is fundamentally evented: upon receiving an input chunk from the client the chunk is relayed to a downstream server. In contrast, the business logic implemented by web applications is more naturally described in a synchronous style. The callbacks required by an evented architecture become unwieldy in complex application code.</p>

<p>Another consideration is memory coordination and consistency. Evented servers executing in a single event loop do not need to worry about the correctness and performance implications of maintaining consistent shared memory, but this may be a problem for threaded servers. Threaded servers therefore attempt to minimize memory shared among threads. This approach works well for the servers that we discussed above - proxies, web applications, background workers, and long poll endpoints - as none of them need to share state internally across client sessions. But fundamentally stateful servers like caches and databases cannot avoid this problem.</p>

<p>The threaded approach can be a non-starter if the underlying platform does not support proper threading. In these cases blocking calls to external resources prevent the process from using the CPU in other threads, even if the blocker is not itself using the CPU. C Ruby falls into this category. In these cases <code>t</code> is effectively 1, making evented architectures relatively more appealing.</p>

<p>In the other extreme, the assumption of <code>t</code> being 25 or even 250 may be too modest for some platforms. These low t values are <a href="http://www.usenix.org/events/hotos03/tech/full_papers/vonbehren/vonbehren_html/index.html">an artifact of threading implementations</a> and not intrinsic to the threading model itself. More scalable threading implementations make threaded servers viable for higher <code>w</code> to <code>c</code> ratios.</p>

<p>An evented approach can be compromised by a lack of evented libraries for the platform. For evented servers to perform optimally, all external resources must be accessed through nonblocking libraries. Such libraries are not always available, especially on platforms that have typically used threaded/blocking models like the JVM and C Ruby. Fortunately this situation is improving as developers <a href="https://netty.io/">publish</a> <a href="https://github.com/AsyncHttpClient/async-http-client">more</a> <a href="http://rubyeventmachine.com/">nonblocking</a> <a href="https://github.com/igrigorik/em-http-request">libraries</a> in response to the demand from implementors of evented servers. Indeed, the requirement of pervasive evented libraries for optimal performance is one reason that <a href="https://nodejs.org/en/">node.js</a> is so compelling for building evented servers.</p>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9878675755379402"
     data-ad-slot="5842766387"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



<br />
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
<a class="a2a_button_reddit"></a>
<a class="a2a_button_hacker_news"></a>
<a class="a2a_button_twitter"></a>
<a class="a2a_button_facebook"></a>
<a class="a2a_button_linkedin"></a>
<a class="a2a_button_google_plus"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>

<br />

        
        </div>
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/developing-and-deploying-clojure-web-application-aws" title="Developing a Simple Clojure Web Application and Deploying to AWS"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/environment-passing-in-clojure" title="Environment Passing in Clojure" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1595681594"></script>
    <script src="/js/perfect-scrollbar.min.js?1595681594"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1595681594"></script>
    <script src="/js/jquery.sticky.js?1595681594"></script>
    <script src="/js/featherlight.min.js?1595681594"></script>
    <script src="/js/html5shiv-printshiv.min.js?1595681594"></script>
    <script src="/js/highlight.pack.js?1595681594"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1595681594"></script>
    <script src="/js/learn.js?1595681594"></script>
    <script src="/js/hugo-learn.js?1595681594"></script>

    <link href="/mermaid/mermaid.css?1595681594" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1595681594"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

